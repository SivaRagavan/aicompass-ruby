<div class="rounded-[18px] border border-[var(--border)] bg-[#fffaf3] p-[30px] shadow-[0_18px_40px_rgba(31,41,51,0.08)]">
  <% company_name = @assessment.company_name.presence || "your company" %>
  <h1 class="text-[28px] tracking-[-0.02em]"><%= company_name %></h1>
  <% assessor_name = @assessment.exec_profile["name"].presence || "Assessor" %>
  <% completed_date = @assessment.updated_at.to_date.strftime("%b %d, %Y") %>

  <div class="flex flex-wrap justify-center gap-6 mb-8">
    <div class="grid justify-items-center gap-2.5">
      <% score_percent = @summary[:composite_score].to_f.round.clamp(0, 100) %>
      <div class="flex flex-col items-center gap-1 text-[#1f2933]">
        <div class="flex flex-col items-center gap-0.5 text-[16px] font-medium uppercase text-[#374151] tracking-[0.04em] text-center">
          <span>AICO Score</span>
          <span class="text-[12px] text-[var(--muted-foreground)] normal-case tracking-normal">AI Compass Outlook Score</span>
        </div>
        <strong class="text-[22px] font-bold"><%= score_percent %></strong>
      </div>
      <div class="h-[12px] w-full max-w-[260px] rounded-full bg-gradient-to-r from-[#dc2626] via-[#f59e0b] to-[#16a34a] relative" style="--score: <%= score_percent %>%;">
        <span class="absolute inset-y-0 right-0 rounded-r-full bg-[#efe6d8]" style="width: calc(100% - <%= score_percent %>%)"></span>
      </div>
    </div>
  </div>

  <h2 class="text-[20px]">Score Breakdown</h2>
  <div class="grid gap-4 rounded-[16px] border border-[var(--border)] bg-[#fffaf3] px-6 py-5 mt-4">
    <% @summary[:pillar_scores].each do |pillar| %>
      <% pillar_scores = @assessment.scores.select { |score| score["pillar_id"] == pillar[:pillar_id] } %>
      <% pillar_percent = pillar[:score].to_f.round.clamp(0, 100) %>
      <div class="grid gap-2.5" data-pillar>
        <button class="flex items-center justify-between text-[13px] text-[#374151]" type="button" data-pillar-toggle>
          <span><%= pillar[:pillar_name] %></span>
          <strong class="text-[14px]"><%= format("%.0f", pillar_percent) %></strong>
        </button>
        <div class="relative h-[12px] rounded-full bg-[#efe6d8] shadow-[inset_0_1px_2px_rgba(31,41,51,0.08)] cursor-pointer overflow-hidden" data-pillar-toggle>
          <span class="absolute inset-0 w-0 bg-gradient-to-r from-[#2f8f62] to-[#1f6f5b]" style="width: <%= [pillar_percent.round, 100].min %>%"></span>
        </div>
        <div class="hidden flex flex-col gap-3 border-t border-dashed pt-3 text-[13px] text-[#4b5563]" data-pillar-metrics>
          <% pillar_scores.each do |score| %>
            <% metric = BenchmarkData.pillar_by_id(score["pillar_id"])&.[](:metrics)&.find { |item| item[:id] == score["metric_id"] } %>
            <% metric_percent = (score["score"].to_f / 3 * 100).round.clamp(0, 100) %>
            <div class="flex items-center justify-between">
              <span><%= metric ? metric[:name] : score["metric_id"] %></span>
              <div class="flex gap-4">
                <span>Score: <%= format("%.0f", metric_percent) %></span>
                <span>Questions: <%= metric ? metric[:questions].length : score["responses"].length %></span>
              </div>
            </div>
          <% end %>
          <% if pillar_scores.empty? %>
            <% BenchmarkData.metrics_for_pillar(pillar[:pillar_id]).each do |metric| %>
              <div class="flex items-center justify-between">
                <span><%= metric[:name] %></span>
                <div class="flex gap-4">
                  <span>Score: 0</span>
                  <span>Questions: <%= metric[:questions].length %></span>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <p class="mt-6 text-[var(--muted-foreground)]">Assessment completed by <%= assessor_name %> on <%= completed_date %></p>
</div>
