<div class="stack">
  <div class="page-header">
    <div>
      <h1>Assessments</h1>
    </div>
    <%= link_to "New assessment", new_assessment_path, class: "button" %>
  </div>

  <div class="assessment-tabs">
    <div class="tab-buttons">
      <%= link_to "Active", dashboard_path(status: "active"), class: "tab-button #{'active' if @status == 'active'}" %>
      <%= link_to "Completed", dashboard_path(status: "completed"), class: "tab-button #{'active' if @status == 'completed'}" %>
      <%= link_to "Cancelled", dashboard_path(status: "cancelled"), class: "tab-button #{'active' if @status == 'cancelled'}" %>
    </div>

    <% if @assessments.empty? %>
      <p class="small-text">No <%= @status %> assessments yet.</p>
    <% else %>
      <div class="grid-two">
        <% @assessments.each do |assessment| %>
          <div class="card">
            <div class="company-header">
              <strong class="company-name"><%= assessment.company_name %></strong>
            </div>
            <div class="company-details">
              <span>Created <%= assessment.created_at.to_date.strftime("%b %d, %Y") %></span>
              <% if @status == "completed" %>
                <span>Completed <%= assessment.updated_at.to_date.strftime("%b %d, %Y") %></span>
                <span><%= assessment_score_label(assessment) %></span>
              <% elsif @status == "active" %>
                <span>Expires <%= assessment.invite_expires_at.to_date.strftime("%b %d, %Y") %></span>
                <span><%= assessment_progress_label(assessment) %></span>
              <% else %>
                <span>Cancelled <%= (assessment.cancelled_at || assessment.updated_at).to_date.strftime("%b %d, %Y") %></span>
                <span><%= assessment_progress_label(assessment) %></span>
              <% end %>
            </div>
            <% if @status == "active" %>
              <div class="card-footer">
                <%= link_to "Resume", invite_path(assessment.invite_token), class: "button outline small" %>
                <button class="button ghost small" type="button" data-copy-link="<%= invite_link(assessment) %>">Copy active link</button>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
